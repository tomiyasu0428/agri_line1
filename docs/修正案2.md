StraightBar Lite 機能削減提案書
削除推奨機能一覧
1. 自動キャリブレーション機能 ❌
関連コード: 約70行

calibPushSample() - サンプル収集
quickCalibrateIfReady() - 12-20m自動補正
linregTE() - 線形回帰計算
headingJitterDeg() - 方位ゆらぎ計算

削除理由:

条件が厳しすぎて実際には動作していない（R²≥0.90、窓12-20m限定）
現場ではAB再設定の方が確実で分かりやすい

2. 自動回転補正機能 ❌
関連コード: 約40行

autoRotateIfReady() - 走行中の傾き補正
getRotatedDirN() - 回転済み方向ベクトル
alongAndPerp() - 進行/垂直成分分解
calib.thetaBias - 補正角度の保持

削除理由:

30m以上走らないと動作しない
「ここをゼロ」ボタンで即座に対応可能

3. 品質メトリクス表示 ❌
関連コード: 約20行

showMetrics() - R²/ゆらぎ/窓長の表示
el.qa - 品質表示要素

削除理由:

農作業中に「R²=0.82」を気にする人はいない
画面の情報過多を避ける

4. Driveモード ❌
関連コード: 約80行

矢印の太さ/長さ可変表示
背景色のグラデーション変化
キャロット（◎）表示
Wide/Normalプリセット切り替え
driveMode, preset 変数と関連ロジック

削除理由:

シンプルな中央バー表示で十分視認可能
運転中は単純な表示の方が判断しやすい
設定項目が増えて操作が複雑化
描画処理が重くなる

削除による効果
コード削減
現在: app.js 約400行
削除後: 約190行（52%削減）

削除される行数:
- キャリブレーション関連: 110行
- Driveモード関連: 80行
- その他関連変数/初期化: 20行
合計: 約210行削減
複雑性の低下
javascript// Before: 複雑な計算と条件分岐
function drawViz(offset){
  // 背景色の条件分岐
  if(driveMode){
    const th=getThresholds();
    const abs=Math.abs(offset);
    if(abs<=th.green) bg='#0f2215'; 
    else if(abs<=th.yellow) bg='#221f0f'; 
    else bg='#2a1111';
    // 矢印の複雑な描画...
  }
}

// After: シンプルな描画のみ
function drawViz(offset){
  const w=el.viz.width,h=el.viz.height;
  ctx.clearRect(0,0,w,h);
  ctx.fillStyle='#0f0f0f';
  ctx.fillRect(0,0,w,h);
  // グリッドと中央線
  // オフセットバーの表示
  const tx=Math.round(cx - offset*m2px);
  ctx.fillStyle='#4de1c1';
  ctx.fillRect(tx-20,h*0.65-35,40,70);
}
本当に必要な機能（残すもの）
コア機能 ✅

AB設定 - 基準線の設定
横ズレ表示 - 大きな数字とバーで視覚化
作業幅設定 - 並行ライン管理
「ここをゼロ」 - 現在位置での補正
最寄ライン - ターゲットライン選択

補助機能 ✅

GPS状態表示（精度/速度/Hz）
位置取得フォールバック（watch→polling）
画面常時ON（Wake Lock）
音声ガイダンス（シンプルな左右案内）

メンテナンス性の向上
Before:

6つの相互依存する関数群
状態管理が複雑（calib.samples, thetaBias等）
デバッグが困難

After:

独立した単機能の関数
状態は最小限（A, B, currentLineIndex）
誰でも理解できるシンプルな流れ

結論
エッセンシャル思考で機能を絞ることで：

信頼性向上 - バグの可能性が激減
保守性向上 - 誰でもメンテナンス可能
性能向上 - 描画処理が軽量化
UX向上 - 操作がシンプルで迷わない

「AB設定して走るだけ」 という本質的な価値に集中することで、現場で本当に使えるアプリになります。
複雑な自動補正よりも、確実に動作する基本機能の方が農作業現場では価値があります。